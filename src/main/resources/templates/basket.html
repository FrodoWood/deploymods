<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout}">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basket</title>
</head>

<body>
    <!-- <div layout:fragment="content">
        <p>This is the basket page</p>
        <p>Number of products: <span th:text="${#lists.size(products)}"></span></p>
        <table>
            <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Rating</th>
                <th>make</th>
                <th>category</th>
                <th>price</th>
                <th>Add</th>
                <th>Quantity</th>
                <th>Reduce</th>
                <th>Option</th>
            </tr>
            <tr th:each="basketProduct : ${products}">
                <td th:text="${basketProduct.product.name}"></td>
                <td th:text="${basketProduct.product.description}"></td>
                <td th:text="${basketProduct.product.rating}"></td>
                <td th:text="${basketProduct.product.make}"></td>
                <td th:text="${basketProduct.product.category}"></td>
                <td th:text="'£' + ${basketProduct.product.price}"></td>
                <td><a th:href = "@{basket/addQuantity/{id}(id=${basketProduct.product.id})}">+1</a></td>
                <td th:text="${basketProduct.quantity}"></td>
                <td><a th:href = "@{basket/reduce/{id}(id=${basketProduct.product.id})}">-1</a></td>
                <td><a th:href="@{basket/removeProduct/{id}(id=${basketProduct.id})}">Delete</a></td>
            </tr>
        </table>
        <br>
        
        <div th:if="${!products.isEmpty()}">
            <form method = "post" action ="#" th:action="@{/basket/clear}" th:object="${basketproduct}">
                <button type="submit">Clear</button>
            </form>
            <br>
            <form method = "post" action ="#" th:action="@{/checkout}">
                <button type="submit">Checkout</button>
            </form>
        </div>

        <br>

        <div th:if="${total > 0}">
            <p th:text="'Total = £' + ${total}"></p>
        </div>
    </div> -->

    <div layout:fragment="content">
        <div class="container my-5">
            <div class="row">
                <div class="col-lg-8 mb-5">
                    <div class="card shadow-lg border-0">
                        <div class="card-header border-0">
                            <h2 class="card-title pt-2">Your Basket</h2>
                        </div>
                        <div class="card-body">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Product</th>
                                        <th>Quantity</th>
                                        <th>Price</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr th:each="basketProduct : ${products}">
                                        <td class="w-50">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <img th:src="@{/images/turbo1.jpg}" class="img-thumbnail border-0" alt="Product Image">
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="row h4" th:text="${basketProduct.product.name}"></div>
                                                    <div class="row" th:text="'Make: ' + ${basketProduct.product.make}"></div>
                                                    <div class="row" th:text="'Model: ' + ${basketProduct.product.model}"></div>
                                                    <div class="row" th:text="'Category: ' + ${basketProduct.product.category}"></div>
                                                    <div class="row mt-2">
                                                        <div class="col p-0">
                                                            <a class="text-decoration-none link-secondary" th:href="@{basket/removeProduct/{id}(id=${basketProduct.id})}"><i class="bi bi-x-lg"></i> Remove item</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="h4">
                                            <span class="flex-row"><a class="link-dark" th:href = "@{basket/reduce/{id}(id=${basketProduct.product.id})}"><i class="bi bi-dash"></i></a></span>
                                            <span class="flex-row mx-2" th:text="${basketProduct.quantity}"></span>
                                            <span class="flex-row"><a class="link-dark" th:href = "@{basket/addQuantity/{id}(id=${basketProduct.product.id})}"><i class="bi bi-plus-lg"></i></i></a></span>
                                        </td>
                                        <td class="h4" th:text="'£' + ${basketProduct.product.price * basketProduct.quantity}"></td>
                                    </tr>
                                </tbody>
                            </table>

                            <div th:if="${!products.isEmpty()}">
                                <form method = "post" action ="#" th:action="@{/basket/clear}" th:object="${basketproduct}">
                                    <button class="btn btn-outline-danger" type="submit">Clear</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card shadow-lg border-0">
                        <div class="card-header border-0">
                            <h2 class="card-title pt-2">Order Summary</h2>
                        </div>
                        <div class="card-body">
                            <p class="card-text">Subtotal: $44.94</p>
                            <p class="card-text">Shipping: $5.00</p>
                            <p class="card-text">Total: $49.94</p>
                            <form method = "post" action ="#" th:action="@{/checkout}">
                                <button class="btn btn-success" type="submit">Checkout</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>